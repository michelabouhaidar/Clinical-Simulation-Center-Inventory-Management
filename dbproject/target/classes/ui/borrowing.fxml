<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/8"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.ui.BorrowingController"
            prefWidth="1920" prefHeight="1080"
            style="-fx-background-color: linear-gradient(to bottom right, #14532d, #22c55e);">

    <!-- Top header -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="10"
              style="-fx-padding: 16 32 16 32;">
            <children>
                <Label text="LAU"
                       style="-fx-text-fill: #f9fafb;
                              -fx-font-size: 22px;
                              -fx-font-weight: bold;"/>

                <Label text="· Clinical Simulator Center Inventory Management"
                       style="-fx-text-fill: #d1fae5;
                              -fx-font-size: 13px;"/>

                <Pane HBox.hgrow="ALWAYS"/>

                <Label fx:id="userLabel"
                       style="-fx-text-fill: #bbf7d0;
                              -fx-font-size: 12px;"/>
            </children>
        </HBox>
    </top>

    <!-- Left navigation -->
    <left>
        <VBox spacing="8"
              style="-fx-background-color: #14532d;
                     -fx-padding: 24 14 24 24;">
            <children>

                <Label text="Navigation"
                       style="-fx-text-fill: #e5e7eb;
                              -fx-font-size: 12px;
                              -fx-font-weight: bold;
                              -fx-padding: 0 0 8 0;"/>

                <Button text="Overview"
                        onAction="#onNavOverview"
                        maxWidth="Infinity"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <Button text="Simulators"
                        onAction="#onNavSimulators"
                        maxWidth="Infinity"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <Button text="Consumables &amp; Stock"
                        onAction="#onNavStock"
                        maxWidth="Infinity"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <!-- Current page (no onAction) -->
                <Button text="Borrowing"
                        maxWidth="Infinity"
                        style="-fx-background-color: rgba(0,0,0,0.22);
                               -fx-text-fill: #f9fafb;
                               -fx-font-weight: bold;
                               -fx-alignment: CENTER_LEFT;
                               -fx-background-radius: 999;
                               -fx-padding: 8 12 8 12;"/>

                <Button text="Maintenance"
                        maxWidth="Infinity"
                        onAction="#onNavMaintentance"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <Button text="Users"
                        maxWidth="Infinity"
                        onAction="#onNavUsers"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <Separator style="-fx-opacity: 0.4; -fx-padding: 8 0 8 0;"/>

                <Button text="Settings"
                        maxWidth="Infinity"
                        onAction="#onNavSettings"
                        style="-fx-background-color: transparent;
                               -fx-text-fill: #f9fafb;
                               -fx-alignment: CENTER_LEFT;
                               -fx-padding: 8 12 8 12;"/>

                <Pane VBox.vgrow="ALWAYS"/>

                <Button text="Logout"
                        onAction="#onLogout"
                        maxWidth="Infinity"
                        style="-fx-background-color: #ef4444;
                               -fx-text-fill: white;
                               -fx-font-weight: bold;
                               -fx-background-radius: 999;
                               -fx-padding: 8 12 8 12;"/>
            </children>
        </VBox>
    </left>

    <!-- Center content -->
    <center>
        <StackPane>
            <padding>
                <Insets top="8" right="8" bottom="8" left="8"/>
            </padding>

            <children>
                <VBox spacing="16"
                      maxWidth="1400"
                      style="-fx-background-color: #f9fafb;
                             -fx-background-radius: 20;
                             -fx-padding: 24;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.28), 24, 0.18, 0, 6);">

                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label text="Borrowing"
                                   style="-fx-text-fill: #111827;
                                          -fx-font-size: 22px;
                                          -fx-font-weight: bold;"/>
                            <Label text="Create borrowings, assign simulators, issue consumables, and manage returns."
                                   style="-fx-text-fill: #6b7280;
                                          -fx-font-size: 12px;"/>
                        </VBox>

                        <Button text="New borrowing"
                                onAction="#onNewBorrowing"
                                style="-fx-background-color: #22c55e;
                                       -fx-text-fill: white;
                                       -fx-font-weight: bold;
                                       -fx-background-radius: 999;
                                       -fx-padding: 8 14 8 14;"/>
                    </HBox>

                    <Separator/>

                    <!-- Filters row -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <TextField fx:id="searchField"
                                   promptText="Search by code, notes, department..."
                                   HBox.hgrow="ALWAYS"
                                   style="-fx-background-radius: 999;
                                          -fx-border-radius: 999;
                                          -fx-border-color: #d1d5db;
                                          -fx-padding: 8 12 8 12;
                                          -fx-background-color: #ffffff;"/>

                        <ComboBox fx:id="statusCombo"
                                  prefWidth="170"
                                  promptText="Status"
                                  style="-fx-background-radius: 999;
                                         -fx-border-radius: 999;
                                         -fx-border-color: #d1d5db;
                                         -fx-padding: 4 10 4 10;
                                         -fx-background-color: #ffffff;"/>

                        <ComboBox fx:id="deptCombo"
                                  prefWidth="240"
                                  promptText="Department"
                                  style="-fx-background-radius: 999;
                                         -fx-border-radius: 999;
                                         -fx-border-color: #d1d5db;
                                         -fx-padding: 4 10 4 10;
                                         -fx-background-color: #ffffff;"/>

                        <DatePicker fx:id="dpFrom" prefWidth="140" promptText="From"/>
                        <DatePicker fx:id="dpTo" prefWidth="140" promptText="To"/>

                        <Button text="Search"
                                onAction="#onSearch"
                                style="-fx-background-color: #22c55e;
                                       -fx-text-fill: white;
                                       -fx-font-weight: bold;
                                       -fx-background-radius: 999;
                                       -fx-padding: 8 14 8 14;"/>

                        <Button text="Clear"
                                onAction="#onClear"
                                style="-fx-background-color: #e5e7eb;
                                       -fx-text-fill: #111827;
                                       -fx-font-weight: bold;
                                       -fx-background-radius: 999;
                                       -fx-padding: 8 14 8 14;"/>
                    </HBox>

                    <!-- Main area -->
                    <HBox spacing="16">

                        <VBox spacing="10" HBox.hgrow="ALWAYS">
                            <TableView fx:id="borrowTable"
                                       prefHeight="320"
                                       style="-fx-background-color: transparent;
                                              -fx-control-inner-background: #ffffff;
                                              -fx-table-cell-border-color: #e5e7eb;
                                              -fx-table-header-border-color: #e5e7eb;">
                                <columns>
                                    <TableColumn fx:id="colId" text="ID" prefWidth="70"/>
                                    <TableColumn fx:id="colCode" text="Code" prefWidth="140"/>
                                    <TableColumn fx:id="colBranch" text="Branch" prefWidth="170"/>
                                    <TableColumn fx:id="colDept" text="Department" prefWidth="220"/>
                                    <TableColumn fx:id="colStart" text="Start" prefWidth="110"/>
                                    <TableColumn fx:id="colEnd" text="End" prefWidth="110"/>
                                    <TableColumn fx:id="colStatus" text="Status" prefWidth="150"/>
                                </columns>
                            </TableView>

                            <Label fx:id="borrowMetaLabel"
                                   wrapText="true"
                                   style="-fx-text-fill: #6b7280;
                                          -fx-font-size: 12px;"/>
                        </VBox>

                        <!-- Actions panel -->
                        <VBox spacing="12"
                              prefWidth="280"
                              style="-fx-background-color: #ffffff;
                                     -fx-background-radius: 14;
                                     -fx-padding: 16;
                                     -fx-border-color: #e5e7eb;
                                     -fx-border-radius: 14;">

                            <Label text="Actions"
                                   style="-fx-text-fill: #111827;
                                          -fx-font-size: 16px;
                                          -fx-font-weight: bold;"/>

                            <Separator/>

                            <Label text="Manage items"
                                   style="-fx-text-fill: #111827;
                                          -fx-font-size: 13px;
                                          -fx-font-weight: bold;"/>

                            <Button text="Add simulators"
                                    onAction="#onAddSimulators"
                                    maxWidth="Infinity"
                                    style="-fx-background-color: #22c55e;
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 999;
                                           -fx-padding: 8 12 8 12;"/>

                            <Button text="Add consumables"
                                    onAction="#onAddConsumables"
                                    maxWidth="Infinity"
                                    style="-fx-background-color: #22c55e;
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 999;
                                           -fx-padding: 8 12 8 12;"/>

                            <Separator/>

                            <Label text="Returns / closure"
                                   style="-fx-text-fill: #111827;
                                          -fx-font-size: 13px;
                                          -fx-font-weight: bold;"/>

                            <Button text="Return selected simulators"
                                    onAction="#onReturnSimulators"
                                    maxWidth="Infinity"
                                    style="-fx-background-color: #0ea5e9;
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 999;
                                           -fx-padding: 8 12 8 12;"/>

                            <Button text="Close borrowing"
                                    onAction="#onCloseBorrowing"
                                    maxWidth="Infinity"
                                    style="-fx-background-color: #111827;
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 999;
                                           -fx-padding: 8 12 8 12;"/>

                            <Button text="Cancel borrowing"
                                    onAction="#onCancelBorrowing"
                                    maxWidth="Infinity"
                                    style="-fx-background-color: #ef4444;
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 999;
                                           -fx-padding: 8 12 8 12;"/>

                            <Separator/>

                            <Label text="Tip: Borrowings can be modified only when ACTIVE / PARTIALLY_RETURNED."
                                   wrapText="true"
                                   style="-fx-text-fill: #6b7280;
                                          -fx-font-size: 11px;"/>
                        </VBox>
                    </HBox>

                    <!-- Details tabs -->
                    <TabPane prefHeight="280">
                        <tabs>
                            <Tab text="Simulators">
                                <content>
                                    <TableView fx:id="borrowSimsTable"
                                               style="-fx-control-inner-background: #ffffff;">
                                        <columns>
                                            <TableColumn fx:id="colSimTag" text="Tag" prefWidth="110"/>
                                            <TableColumn fx:id="colSimModel" text="Model" prefWidth="200"/>
                                            <TableColumn fx:id="colSimSN" text="SN" prefWidth="120"/>
                                            <TableColumn fx:id="colSimStatus" text="Status" prefWidth="120"/>
                                            <TableColumn fx:id="colSimNextCal" text="Next Cal." prefWidth="110"/>
                                            <TableColumn fx:id="colCondOut" text="Cond. Out" prefWidth="130"/>
                                            <TableColumn fx:id="colCondIn" text="Cond. In" prefWidth="130"/>
                                            <TableColumn fx:id="colReturnNotes" text="Return Notes" prefWidth="260"/>
                                        </columns>
                                    </TableView>
                                </content>
                            </Tab>

                            <Tab text="Consumables">
                                <content>
                                    <TableView fx:id="borrowConsTable"
                                               style="-fx-control-inner-background: #ffffff;">
                                        <columns>
                                            <TableColumn fx:id="colConsName" text="Consumable" prefWidth="260"/>
                                            <TableColumn fx:id="colConsMeasure" text="Measure" prefWidth="90"/>
                                            <TableColumn fx:id="colConsQty" text="Borrowed Qty" prefWidth="110"/>
                                            <TableColumn fx:id="colConsAvailNow" text="Avail. Now" prefWidth="100"/>
                                            <TableColumn fx:id="colConsLastCount" text="Last Count" prefWidth="110"/>
                                            <TableColumn fx:id="colConsBranch" text="Branch" prefWidth="170"/>
                                            <TableColumn fx:id="colConsStockId" text="Stock ID" prefWidth="90"/>
                                        </columns>
                                    </TableView>
                                </content>
                            </Tab>
                        </tabs>
                    </TabPane>

                </VBox>
            </children>
        </StackPane>
    </center>

    <!-- Bottom footer -->
    <bottom>
        <HBox alignment="CENTER_RIGHT"
              style="-fx-padding: 4 24 8 24;">
            <children>
                <Label text="LAU · Clinical Simulator Center Inventory"
                       style="-fx-text-fill: #e5e7eb; -fx-font-size: 11px;"/>
            </children>
        </HBox>
    </bottom>

</BorderPane>
